<?xml version="1.0" encoding="utf-8" ?>
<pages:PopupPage xmlns="http://xamarin.com/schemas/2014/forms"
                 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                 xmlns:prism="http://prismlibrary.com"
                 xmlns:pages="clr-namespace:Rg.Plugins.Popup.Pages;assembly=Rg.Plugins.Popup" 
                 xmlns:animations="clr-namespace:Rg.Plugins.Popup.Animations;assembly=Rg.Plugins.Popup"
                 xmlns:pkv="clr-namespace:Xamarin.Forms.PancakeView;assembly=Xamarin.Forms.PancakeView"
                 xmlns:Icons="clr-namespace:Plugin.Iconize;assembly=Plugin.Iconize"
                 xmlns:microCharts="clr-namespace:Microcharts.Forms;assembly=Microcharts.Forms"
                 xmlns:i18n="clr-namespace:Resx;assembly=Resx"
                 prism:ViewModelLocator.AutowireViewModel="True"
                 x:Class="Covid_Info.Views.MyCountryDetails"
                 Visual="Material">

    <pages:PopupPage.Animation>
        <animations:ScaleAnimation 
            PositionIn="Center"
            PositionOut="Bottom"
            ScaleIn="1.2"
            ScaleOut="0.8"
            DurationIn="400"
            DurationOut="300"
            EasingIn="SinOut"
            EasingOut="SinIn"
            HasBackgroundAnimation="True"/>
    </pages:PopupPage.Animation>

    <pkv:PancakeView BackgroundColor="#eceff1"  CornerRadius="10,10,0,0" >
        <pkv:PancakeView.GestureRecognizers>
            <SwipeGestureRecognizer Direction="Down" Command="{Binding CloseCountryDetails}"/>
        </pkv:PancakeView.GestureRecognizers>
        
        <StackLayout Spacing="0">
            <pkv:PancakeView Padding="0" HasShadow="True" >
                <StackLayout>
                    <Icons:IconLabel Text="fas-caret-down"
                               FontSize="Body"
                               FontAttributes="Bold"
                               TextColor="{StaticResource BaseFontColor}"
                               HorizontalOptions="Center"/>
                    <BoxView BackgroundColor="#e8eaf6" HeightRequest="1"/>
                </StackLayout>
                <pkv:PancakeView.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding CloseCountryDetails}"/>
                </pkv:PancakeView.GestureRecognizers>
            </pkv:PancakeView>
            <ScrollView>
                <StackLayout>

                    <pkv:PancakeView BackgroundColor="{StaticResource WhiteColor}" Padding="10">
                        <Label Text="{Binding CountryDetails.country}" TextColor="{StaticResource BaseFontColor}" FontSize="Large" HorizontalOptions="Center" VerticalOptions="Center" FontAttributes="Bold"/>
                    </pkv:PancakeView>
                    <!--<pkv:PancakeView>
                        <Grid>
                            <Image VerticalOptions="Fill" HorizontalOptions="Fill" Aspect="AspectFit" >
                                <Image.Source>
                                    <UriImageSource Uri="{Binding CountryDetails.countryInfo.flag}" CachingEnabled="True" CacheValidity="15"/>
                                </Image.Source>
                            </Image>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="150"/>
                                    <RowDefinition Height="auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="1" Text="{Binding CountryDetails.country}"
                   HorizontalOptions="Center"
                   FontAttributes="Bold"
                   FontSize="Large"
                   TextColor="{StaticResource BaseFontColor}"/>

                            </Grid>

                        </Grid>
                    </pkv:PancakeView>-->

                    <StackLayout Padding="-5" Margin="0,10">
                        
                        <!--Grid today reports-->
                        <Frame Padding="15">
                            <Grid BackgroundColor="{StaticResource BaseFontColor}" ColumnSpacing="1" Padding="1" RowSpacing="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                </Grid.RowDefinitions>

                                <!--TITLE reported today-->
                                <StackLayout Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" BackgroundColor="{StaticResource BaseBlueColor}" Padding="5">
                                    <Label Text="{i18n:Translate 24Report}" FontAttributes="Bold" FontSize="Body" HorizontalOptions="Center" TextColor="{StaticResource WhiteColor}"/>
                                </StackLayout>

                                <!--recovered-->
                                <Label Grid.Row="1" Grid.Column="0" BackgroundColor="#eceff1" Padding="5"
                               Text="{i18n:Translate recoveredCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="1" Grid.Column="1" BackgroundColor="#eceff1"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.todayRecovered, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--cases/active-->
                                <Label Grid.Row="2" Grid.Column="0" BackgroundColor="{StaticResource WhiteColor}" Padding="5"
                               Text="{i18n:Translate activeCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="2" Grid.Column="1" BackgroundColor="{StaticResource WhiteColor}"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.todayCases, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--deaths-->
                                <Label Grid.Row="3" Grid.Column="0" BackgroundColor="#eceff1" Padding="5"
                               Text="{i18n:Translate deathsCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="3" Grid.Column="1" BackgroundColor="#eceff1"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.todayDeaths, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>

                            </Grid>
                        </Frame>

                        <!--Grid general reports-->
                        <Frame Padding="15">
                            <Grid BackgroundColor="{StaticResource BaseFontColor}" ColumnSpacing="1" Padding="1" RowSpacing="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="30"/>
                                </Grid.RowDefinitions>

                                <!--Title total cases-->
                                <StackLayout Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" BackgroundColor="{StaticResource BaseBlueColor}" >
                                    <Label Text="Total cases" FontAttributes="Bold" FontSize="Body" HorizontalOptions="Center" TextColor="{StaticResource WhiteColor}"/>
                                </StackLayout>
                                <!--cases-->
                                <Label Grid.Row="1" Grid.Column="0" BackgroundColor="#eceff1" Padding="5"
                               Text="{i18n:Translate confirmedCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="1" Grid.Column="1" BackgroundColor="#eceff1"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.cases, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--recovered-->
                                <Label Grid.Row="2" Grid.Column="0" BackgroundColor="{StaticResource WhiteColor}" Padding="5"
                               Text="{i18n:Translate recoveredCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="2" Grid.Column="1" BackgroundColor="{StaticResource WhiteColor}"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.recovered, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--active-->
                                <Label Grid.Row="3" Grid.Column="0" BackgroundColor="#eceff1" Padding="5"
                               Text="{i18n:Translate activeCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="3" Grid.Column="1" BackgroundColor="#eceff1"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.active, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--critical-->
                                <Label Grid.Row="4" Grid.Column="0" BackgroundColor="{StaticResource WhiteColor}" Padding="5"
                               Text="critical" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="4" Grid.Column="1" BackgroundColor="{StaticResource WhiteColor}"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.critical, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--deaths-->
                                <Label Grid.Row="5" Grid.Column="0" BackgroundColor="#eceff1" Padding="5"
                               Text="{i18n:Translate deathsCases}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="5" Grid.Column="1" BackgroundColor="#eceff1"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.deaths, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                                <!--tests-->
                                <Label Grid.Row="6" Grid.Column="0" BackgroundColor="{StaticResource WhiteColor}" Padding="5"
                               Text="{i18n:Translate covidTests}" FontSize="Body" TextColor="{StaticResource BaseFontColor}"/>
                                <Label Grid.Row="6" Grid.Column="1" BackgroundColor="{StaticResource WhiteColor}"  Padding="20,5,5,5" 
                                   Text="{Binding CountryDetails.tests, StringFormat='{0:0,0}'}" FontSize="Body"  TextColor="{StaticResource BaseFontColor}"/>
                            </Grid>
                        </Frame>

                        <!--cases chart-->
                        <microCharts:ChartView Chart="{Binding MyCountrChart}" HeightRequest="200"/>

                    </StackLayout>

                </StackLayout>
            </ScrollView>
        </StackLayout>
    </pkv:PancakeView>
</pages:PopupPage>